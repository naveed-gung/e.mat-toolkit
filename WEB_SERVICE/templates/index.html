<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>E.MAT - ETHICAL Malware Analysis Toolkit</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', filename='favicon.svg') }}">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="header-content">
            <div class="logo-title">
                <h1>E.MAT</h1>
                <span class="subtitle">ETHICAL Malware Analysis Toolkit</span>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="main-layout">
        <main>
            <!-- Warning Banner -->
            <div class="warning-banner">
                [!] FOR EDUCATIONAL AND AUTHORIZED RESEARCH ONLY
            </div>

            <!-- Tabs -->
            <div class="tabs">
                <button class="tab-button active" data-tab="file-url">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                    File/URL
                </button>
                <button class="tab-button" data-tab="file-collection">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                    File Collection
                </button>
                <button class="tab-button" data-tab="report-search">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                    Report Search
                </button>
                <button class="tab-button" data-tab="yara-search">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
                    YARA Search
                </button>
                <button class="tab-button" data-tab="string-search">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/></svg>
                    String Search
                </button>
            </div>

            <!-- TAB 1: File/URL -->
            <div class="tab-content active" id="tab-file-url">
                <div class="analysis-card">
                    <p class="description-text">
                        This is a free malware analysis service for the community that detects and
                        analyzes unknown threats using a unique <span class="highlight">Hybrid Analysis</span> technology.
                    </p>
                    <div class="drop-zone" id="dropZone">
                        <div class="drop-icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
                                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                                <circle cx="12" cy="11" r="3"></circle>
                            </svg>
                        </div>
                        <div class="drop-text">Drag &amp; Drop For Instant Analysis</div>
                        <div class="drop-subtext">or click to browse</div>
                    </div>
                    <input type="file" id="fileInput" style="display:none;">
                    <div class="separator-text">or</div>
                    <div class="url-section">
                        <input type="text" class="url-input" placeholder="http://www.example.com/suspicious.zip" id="urlInput">
                        <button class="btn" id="analyzeBtn" disabled><span>Analyze</span></button>
                    </div>
                    <div class="progress-container" id="progressContainer">
                        <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
                        <div class="progress-text" id="progressText">Analyzing...</div>
                    </div>
                    <div class="results-section" id="resultsSection"></div>
                    <p class="description-text" style="margin-top:1.5rem;font-size:0.8rem;">Maximum upload size is 250 MB.</p>
                </div>
            </div>

            <!-- TAB 2: File Collection -->
            <div class="tab-content" id="tab-file-collection">
                <div class="analysis-card">
                    <p class="description-text">
                        Here you can upload and share your file collections. Receive instant threat
                        analysis using <span class="highlight">CrowdStrike Falcon Static Analysis (ML)</span>, reputation lookups,
                        AV engines, static analysis and more. All files uploaded will be made available to the
                        community YARA/String search.
                    </p>
                    <div class="drop-zone" id="collectionDropZone">
                        <div class="drop-icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.5">
                                <circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"/>
                            </svg>
                        </div>
                        <div class="drop-text">Drag &amp; Drop For Instant Analysis</div>
                        <div class="drop-subtext">or click to browse (multiple files)</div>
                    </div>
                    <input type="file" id="collectionFileInput" style="display:none;" multiple>
                    <div id="collectionFileList" class="file-list"></div>
                    <div style="text-align:center;margin-top:1rem;">
                        <button class="btn" id="collectionAnalyzeBtn" disabled>Analyze Collection</button>
                    </div>
                    <div class="progress-container" id="collectionProgress">
                        <div class="progress-bar"><div class="progress-fill" id="collectionProgressFill"></div></div>
                        <div class="progress-text" id="collectionProgressText">Analyzing...</div>
                    </div>
                    <div class="results-section" id="collectionResults"></div>
                </div>
            </div>

            <!-- TAB 3: Report Search -->
            <div class="tab-content" id="tab-report-search">
                <div class="analysis-card">
                    <p class="description-text">
                        Search through Indicators of Compromise (IOCs).
                    </p>
                    <div class="search-icon-container">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.35">
                            <circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/>
                        </svg>
                    </div>
                    <div class="url-section">
                        <input type="text" class="url-input" placeholder="IP, Domain, Hash..." id="reportSearchInput">
                        <button class="btn" id="reportSearchBtn">Search</button>
                    </div>
                    <div class="separator-text">or</div>
                    <div style="text-align:center;">
                        <button class="btn btn-outline" id="reportAdvancedBtn">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                            Advanced Search
                        </button>
                    </div>
                    <div class="results-section" id="reportResults"></div>
                </div>
            </div>

            <!-- TAB 4: YARA Search -->
            <div class="tab-content" id="tab-yara-search">
                <div class="analysis-card">
                    <p class="description-text">
                        Hunt samples matching <a href="https://virustotal.github.io/yara/" target="_blank" rel="noopener" style="color:var(--primary);">YARA</a> rules at the byte level.
                    </p>
                    <div class="drop-zone" id="yaraDropZone">
                        <div class="drop-icon">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.5">
                                <circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"/>
                            </svg>
                        </div>
                        <div class="drop-text">Drag &amp; Drop For YARA Hunting</div>
                        <div class="drop-subtext">Upload a .yar rule file</div>
                    </div>
                    <input type="file" id="yaraRuleInput" style="display:none;" accept=".yar,.yara,.txt">
                    <input type="file" id="yaraTargetInput" style="display:none;">
                    <div id="yaraFileInfo" class="file-list"></div>
                    <div class="separator-text">or</div>
                    <div style="text-align:center;display:flex;gap:1rem;justify-content:center;">
                        <button class="btn" id="yaraTargetBtn">Select Target File</button>
                        <button class="btn btn-outline" id="yaraAdvancedBtn">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                            Advanced Search
                        </button>
                    </div>
                    <div class="progress-container" id="yaraProgress">
                        <div class="progress-bar"><div class="progress-fill" id="yaraProgressFill"></div></div>
                        <div class="progress-text" id="yaraProgressText">Scanning...</div>
                    </div>
                    <div class="results-section" id="yaraResults"></div>
                </div>
            </div>

            <!-- TAB 5: String Search -->
            <div class="tab-content" id="tab-string-search">
                <div class="analysis-card">
                    <p class="description-text">
                        Hunt samples matching strings and hex patterns at the byte level.
                    </p>
                    <div class="search-icon-container">
                        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" opacity="0.35">
                            <ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/><path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/>
                        </svg>
                    </div>
                    <div class="url-section">
                        <input type="text" class="url-input" placeholder="HEX, ASCII string" id="stringSearchInput">
                        <button class="btn" id="stringSearchBtn">Search</button>
                    </div>
                    <div class="separator-text">or</div>
                    <div style="text-align:center;display:flex;gap:1rem;justify-content:center;">
                        <button class="btn" id="stringFileBtn">Select File to Search In</button>
                        <button class="btn btn-outline" id="stringAdvancedBtn">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><line x1="21" y1="21" x2="16.65" y2="16.65"/></svg>
                            Advanced Search
                        </button>
                    </div>
                    <input type="file" id="stringFileInput" style="display:none;">
                    <div id="stringFileInfo" class="file-list"></div>
                    <div class="progress-container" id="stringProgress">
                        <div class="progress-bar"><div class="progress-fill" id="stringProgressFill"></div></div>
                        <div class="progress-text" id="stringProgressText">Searching...</div>
                    </div>
                    <div class="results-section" id="stringResults"></div>
                </div>
            </div>
        </main>

        <!-- History Sidebar -->
        <aside class="history-sidebar" id="historySidebar">
            <h3 class="sidebar-title">Analysis History</h3>
            <div class="history-list" id="historyList">
                <div class="history-empty">No analyses yet. Upload a file to get started.</div>
            </div>
        </aside>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-left">2026 E.MAT</div>
            <div class="footer-center">
                <a href="https://github.com/naveed-gung" target="_blank" rel="noopener">GitHub</a>
                <a href="https://naveed-gung.dev" target="_blank" rel="noopener">Portfolio</a>
            </div>
            <div class="footer-right">ETHICAL Malware Analysis Toolkit</div>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
